plugins {
    id "com.github.johnrengelman.shadow" version "4.0.3"
    id 'application'
}

group 'org.mrcube'
version = '1.0.4'

project.ext {
    artifactId = 'mrcube'
    defaultEncoding = 'UTF-8'
}

repositories {
    jcenter()
    maven {
        url 'http://mrcube.org/mvn_repo/'
    }
    maven {
        url 'http://jfontchooser.sourceforge.jp/repository/'
    }
}

wrapper {
    gradleVersion = '4.10.2'
}

jar {
    into('org/mrcube/resources') {
        from 'src/main/java/org/mrcube/resources'
    }
}

shadowJar {
    manifest {
        attributes 'Main-Class': 'org.mrcube.MR3'
    }
    archiveName = "mrcube.jar"
}

mainClassName = 'org.mrcube.MR3'
sourceCompatibility = targetCompatibility = '1.8'

dependencies {
    compile 'jgraph:jgraph:5.13.0.0'
    compile 'jgraph:jgraphaddons:1.0.2'
    compile 'org.apache.jena:jena-core:3.9.0'
    compile 'net.infonode:idw:1.6.1_gpl'
    compile 'say.swing:jfontchooser:1.0.5'
    compile 'org.slf4j:slf4j-api:1.7.25'
    compile 'org.slf4j:slf4j-log4j12:1.7.5'
    testCompile 'org.junit.jupiter:junit-jupiter-api:5.3.2'
    testCompile 'org.junit.jupiter:junit-jupiter-engine:5.3.2'
    testCompile 'org.junit.platform:junit-platform-launcher:1.3.2'
    testCompile 'org.junit.platform:junit-platform-runner:1.3.2'
}

task zipApp(type: Zip, dependsOn: startShadowScripts) {
    archiveName = "mrcube-${version}.${extension}"

    from('./README.md')
    from('./README.ja.md')
    from('./src/main/resources/License.txt')
    into('bin') {
        from('build/scriptsShadow/mrcube')
        from('build/scriptsShadow/mrcube.bat')
    }

    into('lib') {
        from('build/libs/mrcube.jar')
    }
}

defaultTasks 'zipApp'